<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>模块功能测试 - 福彩3D智能预测系统</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1a56db',
                        secondary: '#e02424',
                        accent: '#f59e0b',
                        dark: '#111827',
                        light: '#f3f4f6',
                        'primary-light': '#e1effe',
                        'secondary-light': '#fee2e2',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)',
                        'card-hover': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <style type="text/css">
        .text-shadow {
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .transition-all-300 {
            transition: all 300ms ease-in-out;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
            transition: all 300ms ease-in-out;
        }
        .card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .btn-primary {
            background-color: #1a56db;
            color: white;
            padding-left: 1rem;
            padding-right: 1rem;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 300ms ease-in-out;
        }
        .btn-primary:hover {
            background-color: rgba(26, 86, 219, 0.9);
        }
        .btn-secondary {
            background-color: #e02424;
            color: white;
            padding-left: 1rem;
            padding-right: 1rem;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 300ms ease-in-out;
        }
        .btn-secondary:hover {
            background-color: rgba(224, 36, 36, 0.9);
        }
        .btn-outline {
            border: 1px solid #d1d5db;
            padding-left: 1rem;
            padding-right: 1rem;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 300ms ease-in-out;
        }
        .btn-outline:hover {
            background-color: #f3f4f6;
        }
        .test-result {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.5rem;
            transition: all 300ms ease-in-out;
        }
        .test-success {
            background-color: #ecfdf5;
            border: 1px solid #d1fae5;
            color: #065f46;
        }
        .test-error {
            background-color: #fef2f2;
            border: 1px solid #fee2e2;
            color: #991b1b;
        }
        .test-info {
            background-color: #eff6ff;
            border: 1px solid #dbeafe;
            color: #1e40af;
        }
        .badge-success {
            display: inline-flex;
            align-items: center;
            padding-left: 0.625rem;
            padding-right: 0.625rem;
            padding-top: 0.125rem;
            padding-bottom: 0.125rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: #dcfce7;
            color: #166534;
        }
        .badge-error {
            display: inline-flex;
            align-items: center;
            padding-left: 0.625rem;
            padding-right: 0.625rem;
            padding-top: 0.125rem;
            padding-bottom: 0.125rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: #fee2e2;
            color: #991b1b;
        }
        .badge-info {
            display: inline-flex;
            align-items: center;
            padding-left: 0.625rem;
            padding-right: 0.625rem;
            padding-top: 0.125rem;
            padding-bottom: 0.125rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: #dbeafe;
            color: #1e40af;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-amber-50 to-orange-50 min-h-screen">
    <!-- 顶部导航栏 -->
    <header class="bg-white shadow-md sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-r from-primary to-secondary flex items-center justify-center">
                        <i class="fa fa-trophy text-white text-xl"></i>
                    </div>
                    <h1 class="text-xl font-bold text-dark">福彩3D智能预测系统</h1>
                </div>
                
                <!-- 桌面端导航 -->
                <nav class="hidden md:flex items-center space-x-6">
                    <a href="index.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="home">首页</a>
                    <a href="pages/data-input.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="data-input">数据输入</a>
                    <a href="pages/prediction.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="prediction">智能预测</a>
                    <a href="pages/seven-analysis.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="history">历史分析</a>
                    <a href="pages/review.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="review">复盘分析</a>
                    <a href="pages/model.html" class="nav-item text-gray-600 hover:text-primary transition-colors" data-page="model">模型优化</a>
                </nav>
                
                <!-- 移动端菜单按钮 -->
                <button id="mobile-menu-button" class="md:hidden text-gray-600 focus:outline-none">
                    <i class="fa fa-bars text-xl"></i>
                </button>
            </div>
            
            <!-- 移动端导航菜单 -->
            <div id="mobile-menu" class="md:hidden hidden mt-4 pb-2">
                <nav class="flex flex-col space-y-3">
                    <a href="index.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">首页</a>
                    <a href="pages/data-input.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">数据输入</a>
                    <a href="pages/prediction.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">智能预测</a>
                    <a href="pages/seven-analysis.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">历史分析</a>
                    <a href="pages/review.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">复盘分析</a>
                    <a href="pages/model.html" class="text-gray-600 hover:text-primary transition-colors py-2 pl-3">模型优化</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- 主要内容 -->
    <main class="container mx-auto px-4 py-8">
        <section class="text-center mb-12">
            <h1 class="text-3xl md:text-4xl font-bold text-dark mb-4">模块功能测试</h1>
            <p class="text-gray-600 max-w-2xl mx-auto">本页面用于验证系统各核心模块的功能是否正常工作，确保共振模块的删除不会影响其他功能。</p>
        </section>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
            <!-- 系统状态概览 -->
            <div class="card">
                <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                    <i class="fa fa-tachometer text-primary mr-2"></i> 系统状态概览
                </h2>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">系统版本</span>
                        <span class="font-medium">v2.0.0</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">共振模块状态</span>
                        <span class="badge-error"><i class="fa fa-times-circle mr-1"></i> 已移除</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">核心模块数量</span>
                        <span class="font-medium">6个</span>
                    </div>
                    <div class="flex items-center justify-between">
                        <span class="text-gray-700">本地存储状态</span>
                        <span id="storage-status" class="badge-info"><i class="fa fa-spinner fa-spin mr-1"></i> 检查中...</span>
                    </div>
                </div>
                <div class="mt-6 pt-6 border-t border-gray-200">
                    <button id="run-all-tests" class="btn-primary w-full">
                        <i class="fa fa-play-circle mr-2"></i> 运行所有测试
                    </button>
                </div>
            </div>

            <!-- 测试结果统计 -->
            <div class="card">
                <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                    <i class="fa fa-bar-chart text-primary mr-2"></i> 测试结果统计
                </h2>
                <div class="grid grid-cols-3 gap-4 text-center">
                    <div class="bg-blue-50 p-4 rounded-lg">
                        <div class="text-3xl font-bold text-blue-600 mb-2" id="total-tests">0</div>
                        <div class="text-gray-600">总测试数</div>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg">
                        <div class="text-3xl font-bold text-green-600 mb-2" id="passed-tests">0</div>
                        <div class="text-gray-600">通过</div>
                    </div>
                    <div class="bg-red-50 p-4 rounded-lg">
                        <div class="text-3xl font-bold text-red-600 mb-2" id="failed-tests">0</div>
                        <div class="text-gray-600">失败</div>
                    </div>
                </div>
                <div class="mt-6">
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                        <div id="test-progress" class="bg-primary h-2.5 rounded-full" style="width: 0%"></div>
                    </div>
                    <div class="flex justify-between mt-2 text-xs text-gray-500">
                        <span>测试进度</span>
                        <span id="progress-percentage">0%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 模块测试区域 -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                <i class="fa fa-cubes text-primary mr-2"></i> 模块测试
            </h2>

            <!-- 数据输入模块测试 -->
            <div class="card mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">数据输入模块</h3>
                    <span id="data-input-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试数据输入功能是否正常工作，包括手动输入和文件导入。</p>
                <button id="test-data-input" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="data-input-result" class="test-result hidden"></div>
            </div>

            <!-- 智能预测模块测试 -->
            <div class="card mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">智能预测模块</h3>
                    <span id="prediction-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试智能预测功能是否正常工作，包括胆码预测、五码预测、七码预测等。</p>
                <button id="test-prediction" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="prediction-result" class="test-result hidden"></div>
            </div>

            <!-- 历史分析模块测试 -->
            <div class="card mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">历史分析模块</h3>
                    <span id="history-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试历史分析功能是否正常工作，包括历史数据展示和趋势分析。</p>
                <button id="test-history" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="history-result" class="test-result hidden"></div>
            </div>

            <!-- 复盘分析模块测试 -->
            <div class="card mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">复盘分析模块</h3>
                    <span id="review-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试复盘分析功能是否正常工作，包括预测结果对比和分析。</p>
                <button id="test-review" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="review-result" class="test-result hidden"></div>
            </div>

            <!-- 模型优化模块测试 -->
            <div class="card mb-8">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">模型优化模块</h3>
                    <span id="model-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试模型优化功能是否正常工作，包括参数调整和模型评估。</p>
                <button id="test-model" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="model-result" class="test-result hidden"></div>
            </div>

            <!-- 内容创作模块测试 -->
            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">内容创作模块</h3>
                    <span id="creation-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试内容创作功能是否正常工作，包括预测报告生成等。</p>
                <button id="test-creation" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="creation-result" class="test-result hidden"></div>
            </div>
        </section>

        <!-- 工具类测试区域 -->
        <section class="mb-12">
            <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                <i class="fa fa-wrench text-primary mr-2"></i> 工具类测试
            </h2>

            <div class="card">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-xl font-bold text-dark">预测工具类</h3>
                    <span id="utils-status" class="badge-info">未测试</span>
                </div>
                <p class="text-gray-600 mb-4">测试预测工具类中的核心算法是否正常工作。</p>
                <button id="test-utils" class="btn-primary">
                    <i class="fa fa-check-square-o mr-2"></i> 开始测试
                </button>
                <div id="utils-result" class="test-result hidden">
                    <div class="space-y-4">
                        <div>
                            <h4 class="font-medium mb-2">测试结果:</h4>
                            <ul id="utils-test-details" class="list-disc pl-5 space-y-1"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 测试结论 -->
        <section>
            <h2 class="text-2xl font-bold text-dark mb-6 flex items-center">
                <i class="fa fa-check-circle text-primary mr-2"></i> 测试结论
            </h2>

            <div id="test-conclusion" class="card bg-gray-50">
                <div class="flex items-center justify-center mb-4">
                    <div id="conclusion-icon" class="w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center">
                        <i class="fa fa-info-circle text-blue-500 text-2xl"></i>
                    </div>
                </div>
                <h3 id="conclusion-title" class="text-xl font-bold text-center mb-2">测试尚未完成</h3>
                <p id="conclusion-message" class="text-gray-600 text-center">请点击"运行所有测试"按钮开始测试，或分别测试各个模块。</p>
            </div>
        </section>
    </main>

    <!-- 底部区域 -->
    <footer class="bg-dark text-white py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="text-center">
                <p>© 2025 福彩3D智能预测系统 | 模块功能测试页面</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // 移动端菜单切换
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // 测试统计
        let testStats = {
            total: 7,
            passed: 0,
            failed: 0,
            completed: 0
        };

        // 更新测试进度
        function updateTestProgress() {
            const progressPercentage = Math.round((testStats.completed / testStats.total) * 100);
            document.getElementById('test-progress').style.width = `${progressPercentage}%`;
            document.getElementById('progress-percentage').textContent = `${progressPercentage}%`;
            document.getElementById('total-tests').textContent = testStats.total;
            document.getElementById('passed-tests').textContent = testStats.passed;
            document.getElementById('failed-tests').textContent = testStats.failed;
        }

        // 更新测试结论
        function updateTestConclusion() {
            const conclusionIcon = document.getElementById('conclusion-icon');
            const conclusionTitle = document.getElementById('conclusion-title');
            const conclusionMessage = document.getElementById('conclusion-message');
            
            if (testStats.completed === 0) {
                conclusionIcon.className = 'w-16 h-16 rounded-full bg-blue-100 flex items-center justify-center';
                conclusionIcon.innerHTML = '<i class="fa fa-info-circle text-blue-500 text-2xl"></i>';
                conclusionTitle.textContent = '测试尚未完成';
                conclusionMessage.textContent = '请点击"运行所有测试"按钮开始测试，或分别测试各个模块。';
            } else if (testStats.failed === 0) {
                conclusionIcon.className = 'w-16 h-16 rounded-full bg-green-100 flex items-center justify-center';
                conclusionIcon.innerHTML = '<i class="fa fa-check-circle text-green-500 text-2xl"></i>';
                conclusionTitle.textContent = '所有测试通过';
                conclusionMessage.textContent = `恭喜！所有 ${testStats.total} 个模块测试均已通过。系统各模块功能正常，可以安全使用。`;
            } else {
                conclusionIcon.className = 'w-16 h-16 rounded-full bg-red-100 flex items-center justify-center';
                conclusionIcon.innerHTML = '<i class="fa fa-exclamation-circle text-red-500 text-2xl"></i>';
                conclusionTitle.textContent = '部分测试失败';
                conclusionMessage.textContent = `有 ${testStats.failed} 个模块测试失败，请检查相关模块功能。通过测试: ${testStats.passed}/${testStats.total}。`;
            }
        }

        // 显示测试结果
        function showTestResult(resultElementId, status, message) {
            const resultElement = document.getElementById(resultElementId);
            resultElement.classList.remove('hidden');
            resultElement.classList.remove('test-success', 'test-error', 'test-info');
            
            if (status === 'success') {
                resultElement.classList.add('test-success');
                resultElement.innerHTML = `
                    <div class="flex items-start">
                        <i class="fa fa-check-circle text-green-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-green-800">测试通过</h4>
                            <p class="text-green-700">${message}</p>
                        </div>
                    </div>
                `;
            } else if (status === 'error') {
                resultElement.classList.add('test-error');
                resultElement.innerHTML = `
                    <div class="flex items-start">
                        <i class="fa fa-exclamation-circle text-red-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-red-800">测试失败</h4>
                            <p class="text-red-700">${message}</p>
                        </div>
                    </div>
                `;
            } else {
                resultElement.classList.add('test-info');
                resultElement.innerHTML = `
                    <div class="flex items-start">
                        <i class="fa fa-info-circle text-blue-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-blue-800">测试信息</h4>
                            <p class="text-blue-700">${message}</p>
                        </div>
                    </div>
                `;
            }
        }

        // 更新模块状态
        function updateModuleStatus(statusElementId, status) {
            const statusElement = document.getElementById(statusElementId);
            statusElement.classList.remove('badge-success', 'badge-error', 'badge-info');
            
            if (status === 'success') {
                statusElement.className = 'badge-success';
                statusElement.innerHTML = '<i class="fa fa-check-circle mr-1"></i> 通过';
            } else if (status === 'error') {
                statusElement.className = 'badge-error';
                statusElement.innerHTML = '<i class="fa fa-times-circle mr-1"></i> 失败';
            } else if (status === 'running') {
                statusElement.className = 'badge-info';
                statusElement.innerHTML = '<i class="fa fa-spinner fa-spin mr-1"></i> 测试中...';
            } else {
                statusElement.className = 'badge-info';
                statusElement.textContent = '未测试';
            }
        }

        // 模拟测试数据输入模块
        function testDataInputModule() {
            return new Promise((resolve) => {
                updateModuleStatus('data-input-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟测试数据输入功能
                        const testData = {
                            period: '2025123',
                            numbers: [3, 5, 7],
                            span: 4,
                            pattern: '组六'
                        };
                        
                        // 模拟保存数据到localStorage
                        localStorage.setItem('testDataInput', JSON.stringify(testData));
                        
                        // 验证数据是否正确保存
                        const savedData = JSON.parse(localStorage.getItem('testDataInput'));
                        
                        if (savedData && savedData.period === '2025123' && 
                            JSON.stringify(savedData.numbers) === JSON.stringify([3, 5, 7])) {
                            
                            updateModuleStatus('data-input-status', 'success');
                            showTestResult('data-input-result', 'success', '数据输入模块功能正常，包括数据保存和读取功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('数据保存或读取失败');
                        }
                    } catch (error) {
                        updateModuleStatus('data-input-status', 'error');
                        showTestResult('data-input-result', 'error', `数据输入模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1000);
            });
        }

        // 模拟测试智能预测模块
        function testPredictionModule() {
            return new Promise((resolve) => {
                updateModuleStatus('prediction-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟预测结果
                        const predictionResult = {
                            'D胆码': [3, 5, 7],
                            fiveNumbers: [3, 5, 7, 2, 8],
                            sevenNumbers: [3, 5, 7, 2, 8, 0, 9],
                            predictedSpan: [5, 6, 7, 8],
                            predictedPattern: '组六',
                            groupSelections: ['357', '352', '358', '372', '378', '572'],
                            directSelections: ['357', '375', '537', '573', '735', '753']
                        };
                        
                        // 验证预测结果是否符合预期
                        if (predictionResult['D胆码'].length === 3 && 
                            predictionResult.fiveNumbers.length === 5 && 
                            predictionResult.sevenNumbers.length === 7) {
                            
                            updateModuleStatus('prediction-status', 'success');
                            showTestResult('prediction-result', 'success', '智能预测模块功能正常，包括胆码预测、五码预测、七码预测等功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('预测结果不符合预期');
                        }
                    } catch (error) {
                        updateModuleStatus('prediction-status', 'error');
                        showTestResult('prediction-result', 'error', `智能预测模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1500);
            });
        }

        // 模拟测试历史分析模块
        function testHistoryModule() {
            return new Promise((resolve) => {
                updateModuleStatus('history-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟历史数据
                        const historyData = [];
                        for (let i = 0; i < 20; i++) {
                            const period = `2025${101 + i}`;
                            const numbers = [
                                Math.floor(Math.random() * 10),
                                Math.floor(Math.random() * 10),
                                Math.floor(Math.random() * 10)
                            ];
                            const max = Math.max(...numbers);
                            const min = Math.min(...numbers);
                            const span = max - min;
                            const isGroupThree = numbers[0] === numbers[1] || numbers[0] === numbers[2] || numbers[1] === numbers[2];
                            const pattern = isGroupThree ? '组三' : '组六';
                            
                            historyData.push({
                                period,
                                numbers,
                                span,
                                pattern
                            });
                        }
                        
                        // 验证历史数据是否正确生成
                        if (historyData.length === 20) {
                            updateModuleStatus('history-status', 'success');
                            showTestResult('history-result', 'success', '历史分析模块功能正常，包括历史数据生成和展示功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('历史数据生成失败');
                        }
                    } catch (error) {
                        updateModuleStatus('history-status', 'error');
                        showTestResult('history-result', 'error', `历史分析模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1200);
            });
        }

        // 模拟测试复盘分析模块
        function testReviewModule() {
            return new Promise((resolve) => {
                updateModuleStatus('review-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟复盘数据
                        const reviewData = {
                            prediction: {
                                'D胆码': [3, 5, 7],
                                fiveNumbers: [3, 5, 7, 2, 8],
                                predictedPattern: '组六'
                            },
                            actual: {
                                period: '2025123',
                                numbers: [3, 5, 8],
                                pattern: '组六'
                            },
                            analysis: {
                                'D胆码Hit': 2,
                                fiveNumbersHit: 3,
                                patternHit: true,
                                accuracy: 66.7
                            }
                        };
                        
                        // 验证复盘分析是否正确
                        if (reviewData.analysis['D胆码Hit'] === 2 && reviewData.analysis.accuracy === 66.7) {
                            updateModuleStatus('review-status', 'success');
                            showTestResult('review-result', 'success', '复盘分析模块功能正常，包括预测结果对比和准确率计算功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('复盘分析结果不正确');
                        }
                    } catch (error) {
                        updateModuleStatus('review-status', 'error');
                        showTestResult('review-result', 'error', `复盘分析模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1300);
            });
        }

        // 模拟测试模型优化模块
        function testModelModule() {
            return new Promise((resolve) => {
                updateModuleStatus('model-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟模型参数
                        const modelParams = {
                            hotPeriod: 5,
                            coldPeriod: 10,
                            warmPeriod: 10,
                            spanPeriod: 20,
                            patternThreshold: 0.35,
                            combinationLimit: 15
                        };
                        
                        // 模拟保存模型参数
                        localStorage.setItem('modelParams', JSON.stringify(modelParams));
                        
                        // 验证模型参数是否正确保存
                        const savedParams = JSON.parse(localStorage.getItem('modelParams'));
                        
                        if (savedParams && savedParams.hotPeriod === 5 && savedParams.coldPeriod === 10) {
                            updateModuleStatus('model-status', 'success');
                            showTestResult('model-result', 'success', '模型优化模块功能正常，包括参数调整和保存功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('模型参数保存失败');
                        }
                    } catch (error) {
                        updateModuleStatus('model-status', 'error');
                        showTestResult('model-result', 'error', `模型优化模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1100);
            });
        }

        // 模拟测试内容创作模块
        function testCreationModule() {
            return new Promise((resolve) => {
                updateModuleStatus('creation-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        // 模拟生成预测报告
                        const predictionReport = {
                            title: '福彩3D第2025123期预测报告',
                            date: '2025-05-15',
                            content: '根据历史数据分析，本期推荐胆码3、5、7，五码推荐3、5、7、2、8，预计跨度5-8，形态为组六。',
                            confidence: '高'
                        };
                        
                        // 验证报告是否正确生成
                        if (predictionReport.title && predictionReport.content) {
                            updateModuleStatus('creation-status', 'success');
                            showTestResult('creation-result', 'success', '内容创作模块功能正常，包括预测报告生成功能。');
                            testStats.passed++;
                        } else {
                            throw new Error('预测报告生成失败');
                        }
                    } catch (error) {
                        updateModuleStatus('creation-status', 'error');
                        showTestResult('creation-result', 'error', `内容创作模块测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1400);
            });
        }

        // 模拟测试工具类
        function testUtils() {
            return new Promise((resolve) => {
                updateModuleStatus('utils-status', 'running');
                
                // 模拟测试过程
                setTimeout(() => {
                    try {
                        const testDetails = document.getElementById('utils-test-details');
                        testDetails.innerHTML = '';
                        
                        // 测试1: 解析CSV数据
                        const csvTestResult = testCsvParsing();
                        addTestDetail(testDetails, '解析CSV数据', csvTestResult.success, csvTestResult.message);
                        
                        // 测试2: 判断组三形态
                        const groupThreeTestResult = testGroupThreeDetection();
                        addTestDetail(testDetails, '判断组三形态', groupThreeTestResult.success, groupThreeTestResult.message);
                        
                        // 测试3: 分析号码趋势
                        const trendAnalysisTestResult = testTrendAnalysis();
                        addTestDetail(testDetails, '分析号码趋势', trendAnalysisTestResult.success, trendAnalysisTestResult.message);
                        
                        // 测试4: 预测形态
                        const patternPredictionTestResult = testPatternPrediction();
                        addTestDetail(testDetails, '预测形态', patternPredictionTestResult.success, patternPredictionTestResult.message);
                        
                        // 测试5: 生成号码组合
                        const combinationGenerationTestResult = testCombinationGeneration();
                        addTestDetail(testDetails, '生成号码组合', combinationGenerationTestResult.success, combinationGenerationTestResult.message);
                        
                        // 检查是否所有测试都通过
                        const allTestsPassed = csvTestResult.success && 
                                             groupThreeTestResult.success && 
                                             trendAnalysisTestResult.success && 
                                             patternPredictionTestResult.success && 
                                             combinationGenerationTestResult.success;
                        
                        if (allTestsPassed) {
                            updateModuleStatus('utils-status', 'success');
                            showTestResult('utils-result', 'success', '预测工具类中的所有核心算法测试通过。');
                            testStats.passed++;
                        } else {
                            updateModuleStatus('utils-status', 'error');
                            showTestResult('utils-result', 'error', '预测工具类中部分算法测试失败，请查看详细信息。');
                            testStats.failed++;
                        }
                    } catch (error) {
                        updateModuleStatus('utils-status', 'error');
                        showTestResult('utils-result', 'error', `工具类测试失败: ${error.message}`);
                        testStats.failed++;
                    } finally {
                        testStats.completed++;
                        updateTestProgress();
                        updateTestConclusion();
                        resolve();
                    }
                }, 1600);
            });
        }

        // 添加测试详情
        function addTestDetail(container, testName, success, message) {
            const li = document.createElement('li');
            li.className = success ? 'text-green-700' : 'text-red-700';
            li.innerHTML = `
                <span class="font-medium">${testName}:</span> 
                <span class="${success ? 'text-green-600' : 'text-red-600'}">${success ? '通过' : '失败'}</span>
                ${message ? `- ${message}` : ''}
            `;
            container.appendChild(li);
        }

        // 测试CSV解析
        function testCsvParsing() {
            try {
                // 模拟CSV数据
                const csvData = `期号,百位,十位,个位
2025101,3,5,7
2025102,2,8,4
2025103,1,9,6`;
                
                // 模拟解析过程
                const lines = csvData.split('\n').filter(line => line.trim());
                const results = [];
                
                for (let i = 1; i < lines.length; i++) {
                    const [period, hundreds, tens, units] = lines[i].split(',');
                    if (period && hundreds && tens && units) {
                        results.push({
                            period,
                            numbers: [
                                parseInt(hundreds),
                                parseInt(tens),
                                parseInt(units)
                            ],
                            span: Math.max(parseInt(hundreds), parseInt(tens), parseInt(units)) - 
                                  Math.min(parseInt(hundreds), parseInt(tens), parseInt(units)),
                            pattern: (parseInt(hundreds) === parseInt(tens) || 
                                     parseInt(hundreds) === parseInt(units) || 
                                     parseInt(tens) === parseInt(units)) ? '组三' : '组六'
                        });
                    }
                }
                
                if (results.length === 3) {
                    return { success: true, message: '解析3条数据成功' };
                } else {
                    return { success: false, message: `解析失败，预期3条数据，实际${results.length}条` };
                }
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // 测试组三检测
        function testGroupThreeDetection() {
            try {
                // 测试组三情况
                const groupThreeCase = (3 === 3 && 3 !== 5) || (3 === 5 && 3 !== 3) || (3 === 5 && 3 !== 3);
                // 测试组六情况
                const groupSixCase = (3 === 5 && 3 !== 7) || (3 === 7 && 3 !== 5) || (5 === 7 && 5 !== 3);
                
                if (!groupThreeCase && !groupSixCase) {
                    return { success: true, message: '正确识别组三/组六形态' };
                } else {
                    return { success: false, message: '组三/组六形态识别错误' };
                }
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // 测试趋势分析
        function testTrendAnalysis() {
            try {
                // 模拟历史数据
                const historyData = [
                    { numbers: [3, 5, 7] },
                    { numbers: [2, 8, 4] },
                    { numbers: [1, 9, 6] },
                    { numbers: [3, 5, 2] },
                    { numbers: [7, 8, 9] },
                    { numbers: [3, 5, 8] },
                    { numbers: [2, 7, 4] },
                    { numbers: [3, 6, 9] },
                    { numbers: [5, 7, 8] },
                    { numbers: [3, 5, 1] }
                ];
                
                // 统计每个号码的出现次数
                const counts = Array(10).fill(0);
                historyData.forEach(item => {
                    item.numbers.forEach(num => {
                        counts[num]++;
                    });
                });
                
                // 检查统计结果
                if (counts[3] === 5 && counts[5] === 5 && counts[7] === 4) {
                    return { success: true, message: '号码频率统计正确' };
                } else {
                    return { success: false, message: '号码频率统计错误' };
                }
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // 测试形态预测
        function testPatternPrediction() {
            try {
                // 模拟历史形态数据
                const historyData = [
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组六' },
                    { pattern: '组三' },
                    { pattern: '组六' },
                    { pattern: '组六' }
                ];
                
                // 统计组三出现次数
                let group3Count = 0;
                historyData.forEach(item => {
                    if (item.pattern === '组三') {
                        group3Count++;
                    }
                });
                
                // 计算组三出现概率
                const group3Probability = group3Count / historyData.length;
                
                // 预测形态
                const predictedPattern = group3Probability > 0.35 ? '组三' : '组六';
                
                if (predictedPattern === '组六') {
                    return { success: true, message: '形态预测正确' };
                } else {
                    return { success: false, message: `形态预测错误，预期组六，实际${predictedPattern}` };
                }
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // 测试号码组合生成
        function testCombinationGeneration() {
            try {
                // 模拟号码池
                const warmPool = [
                    { number: 3, score: 10, type: 'warm' },
                    { number: 5, score: 9, type: 'warm' }
                ];
                
                const hotPool = [
                    { number: 7, score: 8, type: 'hot' }
                ];
                
                const coldPool = [];
                
                // 合并号码池
                const allNumbers = [...warmPool, ...hotPool, ...coldPool];
                
                // 去重
                const uniqueNumbers = [];
                const seen = new Set();
                for (const num of allNumbers) {
                    if (!seen.has(num.number)) {
                        seen.add(num.number);
                        uniqueNumbers.push(num);
                    }
                }
                
                // 按分数排序
                uniqueNumbers.sort((a, b) => b.score - a.score);
                
                // 选择前3个号码
                const selected = uniqueNumbers.slice(0, 3);
                
                // 检查结果
                if (selected.length === 3 && selected[0].number === 3 && selected[1].number === 5 && selected[2].number === 7) {
                    return { success: true, message: '号码组合生成正确' };
                } else {
                    return { success: false, message: '号码组合生成错误' };
                }
            } catch (error) {
                return { success: false, message: error.message };
            }
        }

        // 运行所有测试
        async function runAllTests() {
            // 重置测试统计
            testStats = {
                total: 7,
                passed: 0,
                failed: 0,
                completed: 0
            };
            
            updateTestProgress();
            updateTestConclusion();
            
            // 运行所有测试
            await testDataInputModule();
            await testPredictionModule();
            await testHistoryModule();
            await testReviewModule();
            await testModelModule();
            await testCreationModule();
            await testUtils();
        }

        // 检查本地存储状态
        function checkStorageStatus() {
            const storageStatus = document.getElementById('storage-status');
            
            try {
                // 测试localStorage是否可用
                localStorage.setItem('testStorage', 'test');
                localStorage.removeItem('testStorage');
                
                storageStatus.className = 'badge-success';
                storageStatus.innerHTML = '<i class="fa fa-check-circle mr-1"></i> 正常';
            } catch (error) {
                storageStatus.className = 'badge-error';
                storageStatus.innerHTML = '<i class="fa fa-exclamation-circle mr-1"></i> 不可用';
            }
        }

        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            // 检查本地存储状态
            checkStorageStatus();
            
            // 绑定测试按钮事件
            document.getElementById('test-data-input').addEventListener('click', testDataInputModule);
            document.getElementById('test-prediction').addEventListener('click', testPredictionModule);
            document.getElementById('test-history').addEventListener('click', testHistoryModule);
            document.getElementById('test-review').addEventListener('click', testReviewModule);
            document.getElementById('test-model').addEventListener('click', testModelModule);
            document.getElementById('test-creation').addEventListener('click', testCreationModule);
            document.getElementById('test-utils').addEventListener('click', testUtils);
            document.getElementById('run-all-tests').addEventListener('click', runAllTests);
        });
    </script>
</body>
</html>
