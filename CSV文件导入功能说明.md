# CSV文件导入功能说明

## 功能概述

系统现在已支持支持持Excelcel文件导入功能，新增现csv文件导入功能。用户现在可以上传CSV格式的开奖数据文件，系统会自动解析并导入数据。

## 文件格式要求

### 1. 文件格式
- 支持的格式：.csv
- 编码格式：UTF-8
- 分隔符：逗号（,）

### 2. 表头要求
CSV文件的第一行必须包含以下表头（不区分大小写）：
- 期号
- 百位
- 十位
- 个位

表头示例：
```
期号,百位,十位,个位
```

### 3. 数据格式要求

#### 期号
- 格式：6位数字
- 示例：202301, 202302, ..., 2023365

#### 开奖号码
- 百位、十位、个位各为0-9的数字
- 每个位置只能有一个数字

### 4. 数据示例

```
期号,百位,十位,个位
202301,1,2,3
202302,4,5,6
202303,7,8,9
202304,0,1,2
202305,3,4,5
```

## 与Excel文件的区别

1. **文件格式**：
   - CSV：文本文件，使用逗号分隔字段
   - Excel：二进制文件，支持多个工作表

2. **处理方式**：
   - CSV：直接读取文本内容，自行解析
   - Excel：使用SheetJS库解析

3. **优缺点**：
   - CSV：文件体积小，兼容性好，但不支持复杂格式
   - Excel：支持复杂格式和多个工作表，但文件体积较大

## 常见问题及解决方案

### 1. "文件格式不正确"错误

**可能原因**：
- 文件扩展名不是.csv
- 文件编码不是UTF-8
- 分隔符不是逗号

**解决方案**：
- 确保文件扩展名为.csv
- 使用UTF-8编码保存文件
- 使用逗号作为字段分隔符

### 2. "表头不完整"错误

**可能原因**：
- 缺少必要的表头
- 表头名称不正确
- 表头顺序错误

**解决方案**：
- 确保包含"期号"、"百位"、"十位"、"个位"表头
- 检查表头名称是否正确
- 表头顺序不影响导入，系统会根据表头名称匹配

### 3. "数据格式不正确"错误

**可能原因**：
- 期号不是6位数字
- 开奖号码不是0-9的数字
- 数据类型不匹配

**解决方案**：
- 确保期号为6位数字
- 确保开奖号码为0-9的数字
- 检查数据类型是否正确

## 最佳实践

1. **文件准备**：
   - 使用UTF-8编码保存CSV文件
   - 使用逗号作为字段分隔符
   - 确保表头名称正确

2. **数据验证**：
   - 在导入前检查数据格式
   - 确保期号为6位数字
   - 确保开奖号码为0-9的数字

3. **批量导入**：
   - 对于大量数据，建议使用CSV格式
   - CSV文件体积小，导入速度快

## 示例文件

您可以在`test-data`目录下找到示例文件`sample-lottery-data.csv`，该文件包含了20期符合格式要求的开奖数据。

## 注意事项

1. CSV文件不支持多个工作表，所有数据必须在一个工作表中
2. CSV文件不支持单元格格式，所有数据将被视为文本
3. 如果CSV文件中包含逗号，需要使用双引号将字段括起来
4. 系统会自动处理带引号的字段，例如："2023,01",1,2,3
